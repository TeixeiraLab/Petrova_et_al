# Petrova_et_al

This repository contains DNA-PAINT analysis codes designed for filtering non-specific binding events and unwanted localizations, as well as calculating distances between clusters. The code processes data generated by the DNA-PAINT technique, specifically addressing issues related to non-specific binding and unwanted localizations. Additionally, the scripts calculate distances between clusters, providing insights into spatial relationships within the analyzed data.

===========

# Picasso Files Filtering Script 

## Description
This script filters data from HDF5 files generated from Picasso based on specified thresholds and generates histograms for selected columns. The filtered data is saved as a CSV file, and histograms are saved as JPG files.

## Files
1. **Script: `hdf5_filtering_script.py`**
   - Main script with functions for data filtering and histogram plotting.

## Dependencies
- Requires: `os`, `pandas`, `numpy`, `h5py`, `seaborn`.

## Functions

### `plot_and_save_histogram(data, column, result_name)`
- Plots a histogram for a specified column in the given DataFrame.
- Saves the histogram as a JPG file.

### `filter_and_save_data(file_name, result_name, thresholds)`
- Filters data from an HDF5 file generated from Picasso based on specified thresholds.
- Saves the filtered data as a CSV file and generates histograms.

### `process_files(file_paths, result_names, thresholds)`
- Processes multiple HDF5 files generated from Picasso, filters data, and generates histograms.

## Usage
1. Place HDF5 files in the script directory.

2. Adjust file paths, result names, and thresholds in the `__main__` section if needed.

3. Run the script:
   ```bash
   python hdf5_filtering_script.py
4. Filtered data CSV files and histograms will be generated for each input HDF5 file.

# Cluster Filtering Script 

## Description
This script analyzes cluster data in CSV files, filtering non-specific binding events. Results are saved in separate CSV files per input, and a consolidated file is created.

## Files
1. **Script: `cluster_processing_script.py`**
   - Main script with functions for data processing.

2. **Input Files:**
   - `image_i_filtered_DataCalled.csv`: Cluster data for images.
   - `image_i_filtered_ClusterStats.csv`: Cluster stats for images.

3. **Output Files:**
   - `image_i_stat.csv`: Statistics for receptor clusters.
   - `image_i_result.csv`: Filtered receptor clusters.
   - `allstats.csv`: Consolidated statistics.
   - 
## Dependencies
Requires: os, pandas, seaborn, glob.

## Functions

### `filter_non_specific_binding(df, thresholds)`
- Filters non-specific binding using mean and standard deviation.

### `filter_receptor_artificial_clusters(df_cluster_stats, df_filtered_clusters)`
- Separates receptor and artificial clusters.

### `calculate_cluster_statistics(df)`
- Calculates receptor clusters' statistics.

### `loop_function(file_name, file_name_2, result_name, thresholds)`
- Processes files, filters clusters, and saves results.

## Usage
1. Place CSV files in the script directory.

2. Adjust thresholds in `loop_function` if needed.

3. Run:
   ```bash
   python cluster_processing_script.py
4. Results saved in CSV files.


# Edge Distances Calculation Script Readme

## Description
This script calculates edge distances between clusters in CSV files. It produces a DataFrame with ClusterID, NearestClusterID, and EdgeDistance columns. The script also saves the result DataFrame to a new CSV file and generates a histogram plot of the edge distances.

## Files
1. **Script: `edge_distances_script.py`**
   - Main script with functions for edge distances calculation and result visualization.

## Dependencies
- Requires: `os`, `glob`, `pandas`, `numpy`, `scipy`, `matplotlib`.

## Functions

### `calculate_edge_distances(data)`
- Calculates edge distances between clusters in the given DataFrame.
- Returns a DataFrame with ClusterID, NearestClusterID, and EdgeDistance columns.

### `save_result_csv_and_plot(result_df, csv_file)`
- Saves the result DataFrame to a new CSV file.
- Plots the edge distances histogram.

### `process_csv_files()`
- Main function to process multiple CSV files and calculate edge distances.

## Usage
1. Place CSV files in the script directory.

2. Run the script:
   ```bash
   python edge_distances_script.py

3. Resulting CSV files and edge distance histograms will be generated for each input CSV.

4. The script will print the mean edge distance for each CSV file.

