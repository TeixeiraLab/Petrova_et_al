# Petrova_et_al

This repository contains DNA-PAINT analysis codes designed for filtering non-specific binding events and unwanted localizations, as well as calculating distances between clusters. The code processes data generated by the DNA-PAINT technique, specifically addressing issues related to non-specific binding and unwanted localizations. Additionally, the scripts calculate distances between clusters, providing insights into spatial relationships within the analyzed data.

# Cluster Filtering Script 

## Description
This script analyzes cluster data in CSV files, filtering non-specific binding events and categorizing clusters into receptor and artificial. Results are saved in separate CSV files per input, and a consolidated file is created.

## Files
1. **Script: `cluster_processing_script.py`**
   - Main script with functions for data processing.

2. **Input Files:**
   - `image_i_filtered_DataCalled.csv`: Cluster data for images (i = 1 to 8).
   - `image_i_filtered_ClusterStats.csv`: Cluster stats for images (i = 1 to 8).

3. **Output Files:**
   - `image_i_stat.csv`: Statistics for receptor clusters (i = 1 to 8).
   - `image_i_result.csv`: Filtered receptor clusters (i = 1 to 8).
   - `allstats.csv`: Consolidated statistics.

## Functions

### `filter_non_specific_binding(df, thresholds)`
- Filters non-specific binding using mean and standard deviation.

### `filter_receptor_artificial_clusters(df_cluster_stats, df_filtered_clusters)`
- Separates receptor and artificial clusters.

### `calculate_cluster_statistics(df)`
- Calculates receptor clusters' statistics.

### `loop_function(file_name, file_name_2, result_name, thresholds)`
- Processes files, filters clusters, and saves results.

## Usage
1. Place CSV files in the script directory.

2. Adjust thresholds in `loop_function` if needed.

3. Run:
   ```bash
   python cluster_processing_script.py

# DNA-PAINT Cluster Analysis

This repository contains Python scripts for analyzing DNA-PAINT data, specifically focusing on filtering non-specific binding events, unwanted localizations, and calculating distances between clusters.

## Script Descriptions:

### `calculate_edge_distances(data)`

Calculates the edge distances between clusters in the given DataFrame.

- **Parameters:**
  - `data`: DataFrame containing cluster data.
- **Returns:**
  - DataFrame with columns: ClusterID, NearestClusterID, and EdgeDistance.

### `save_result_csv_and_plot(result_df, csv_file)`

Saves the result DataFrame to a new CSV file and plots the edge distances histogram.

- **Parameters:**
  - `result_df`: DataFrame with ClusterID, NearestClusterID, and EdgeDistance columns.
  - `csv_file`: Path to the input CSV file.
- **Returns:**
  - None

### `process_csv_files()`

Main function to process multiple CSV files and calculate edge distances.

- **Parameters:**
  - None
- **Returns:**
  - None

## Usage:

1. Ensure you have Python installed on your machine.
2. Place your CSV files in the same directory as the script.
3. Run the script using `python script_name.py` in the terminal.

The script will process each CSV file, calculate edge distances between clusters, save results in new CSV files, and generate histograms for edge distances.

